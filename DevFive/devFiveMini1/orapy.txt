import cx_Oracle
import pandas as pd

# 오라클 데이터베이스 연결 설정
dsn = cx_Oracle.makedsn('localhost', 1521, 'xe')
db = cx_Oracle.connect('scott', 'tiger', dsn=dsn)

# 커서 생성
cursor = db.cursor()

# SQL 쿼리 실행
cursor.execute("SELECT * FROM emp")

# 결과 가져오기
rows = cursor.fetchall()

# 컬럼 이름 가져오기
colnames = [desc[0] for desc in cursor.description]

# Pandas 데이터 프레임으로 변환
emp = pd.DataFrame(rows, columns=colnames)

# 결과 출력
print(emp)

# 연결 및 리소스 정리
cursor.close()
db.close()
